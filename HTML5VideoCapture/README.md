HTML5视频截图器
=========================

[脚本发布页](https://greasyfork.org/zh-CN/scripts/370819)

[个人脚本仓库](https://github.com/indefined/UserScripts)

[问题反馈到这里](https://github.com/indefined/UserScripts/issues)

**提交问题前请仔细读完说明和使用须知**

-------------------------
## 功能

- 检测网页中的HTML5视频
- 自动将所选中视频滚动到视野中
- HTML5视频控制(暂停/播放/速度控制/步进)
- 视频截图(png格式原始视频画面)
- jpg截图压缩并自动下载(适用于部分视频和浏览器)

![功能界面](https://greasyfork.org/system/screenshots/screenshots/000/011/874/original/HTML5VideoCapture.capture.jpg)

## 使用说明

- 脚本启动：使用脚本管理器安装脚本，在脚本管理器按钮上点击‘启用HTML5视频截图器’打开工具栏
  - ![脚本启动](https://greasyfork.org/system/screenshots/screenshots/000/011/875/original/HTML5VideoCapture.TM.jpg) ![脚本启动](https://greasyfork.org/system/screenshots/screenshots/000/011/876/original/HTML5VideoCapture.VM.jpg)

- 视频识别
  - 工具栏启动会自动检测网页中存在的HTML5视频并选中第一个视频作为操作对象
  - 如页面内容变更，点击工具栏上的检测按钮可以重新检测网页中的视频
  - 如果网页中存在多个视频，从下拉框中选择需要操作的对象，被选中的视频会自动滚动到视野内

- 视频控制：目前工具栏提供播放/暂停、视频速度、视频步进三种类型功能对视频进行操作
  - 具体功能将鼠标指针悬停在按钮上会有相应功能提示
  - 并不一定对所有视频管用，不同网页表现差异较大，具体问题请看[使用须知](#使用须知)

- 截图
  - 如果视频源和浏览器支持，点击截图右侧的↓箭头可以直接下载一张jpg格式截图，体积只有原始图片的20%左右
  - 如果视频或者浏览器不支持，点击↓箭头和点截图一样会打开一个新窗口显示当前视频画面，在画面上右键另存可得到png格式原始截图
  - 或许你也可以拿它来截一些直播，不过适用性应该会比截普通视频差，控制按钮也不一定生效

-------------------------
## 兼容性

- chrome 67 in Tampermonkey4.6 、书签测试通过
- 火狐 in Tampermonkey4.7 、Violentmonkey 、书签测试通过
- 不兼容Greasemonkey4，因为GM4取消了菜单注册，使用GM4安装脚本会在所有网页自动弹出截图工具栏
- 使用书签打开工具栏只对没有在嵌入框体中的视频有效
- 其它浏览器和脚本管理器未知

-------------------------
## 使用须知

- 功能依赖HTML5，对大部分HTML5视频有效，不支持FLASH或其它类型视频。如果有明确不支持的HTML5网页请提交反馈
- 如果播放器在播放过程中发生变更（换源或重载）脚本可能会操作失败，此时一般重新检测可以解决
- 播放暂停控制按钮不一定对所有视频生效，或者有时生效但是在网页上会表现很怪异（比如转圈/遮罩层/弹幕没停止）
- 逐帧控制会暂停视频，但并不一定适用于所有视频，有些播放器改变时间轴后会自动播放所以控制会失效
- 逐帧控制使用60fps的帧率进行控制，这个数据并不一适用于所有视频，所以实际控制并不一定是逐帧的
- 逐帧控制时画面并不一定会实时响应，特别是你快速点了很多下的情况下一般要等播放器缓过来
- 截取到的图片尺寸为视频的原始大小，和当前播放器窗口大小无关，不会包含播放暂停按钮、弹幕等非视频内的内容
- 直接下载截图并不一定对所有视频和浏览器有效，有时可能和点截图按钮效果一样，甚至可能点了完全没有反应
- 新建页面打开截图可能会被浏览器拦截，如果提示被拦截需要先允许弹出窗口再重新截图
- 脚本检测到的视频并不一定都是你能看到的，可能会有一些隐藏视频或空视频标签，自行在下拉框中寻找合适的进行操作
